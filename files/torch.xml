<Entity tags="kickable,teleportable_NOT,prop,torch">

  <ItemComponent
    _tags="enabled_in_world"
    item_name="Torch"
    ui_description="Portable fire"
    ui_sprite="data/ui_gfx/gun_actions/torch.png"
    max_child_items="0"
    is_pickable="1"
    is_equipable_forced="1"
    preferred_inventory="QUICK"
  ></ItemComponent>

  <UIInfoComponent
    _tags="enabled_in_world"
    name="Torch"
  ></UIInfoComponent>

	<AbilityComponent
		ui_name="Torch"
		throw_as_item="1"
		><gun_config
			deck_capacity="0"
		></gun_config>
	</AbilityComponent>

  <VelocityComponent
    _tags="enabled_in_world"
  	gravity_y="400"
  	air_friction="0.55"
  	terminal_velocity="1000"
  ></VelocityComponent>

  <SimplePhysicsComponent
    _tags="enabled_in_world"
  ></SimplePhysicsComponent>

  <HitboxComponent
    _tags="enabled_in_world"
    aabb_min_x="-3"
    aabb_max_x="3"
    aabb_min_y="-5"
    aabb_max_y="0"
    is_enemy="0"
    is_item="0"
    is_player="0"
  ></HitboxComponent>

  <SpriteComponent
    _tags="enabled_in_world,character"
    alpha="1"
    image_file="data/items_gfx/torch.xml"
    next_rect_animation="default"
    rect_animation="default"
  ></SpriteComponent>

  <Entity name="sprite">

    <InheritTransformComponent
      only_position="1"
    ></InheritTransformComponent>

    <SpriteComponent
      _tags="enabled_in_hand,enabled_in_world"
      image_file="data/items_gfx/torch.xml"
      next_rect_animation="default"
      rect_animation="default"
    ></SpriteComponent>

    <LightComponent
      _tags="enabled_in_hand,enabled_in_world,fire"
      r="255"
      g="168"
      b="155"
      radius="64"
      fade_out_time="0.75"
    ></LightComponent>

    <ParticleEmitterComponent
      _tags="enabled_in_hand,enabled_in_world,fire"
      emitted_material_name="smoke"
      offset.x="1"
      offset.y="-6"
      x_pos_offset_min="0"
      x_pos_offset_max="0"
      y_pos_offset_min="-1"
      y_pos_offset_max="1"
      x_vel_min="-10"
      x_vel_max="10"
      y_vel_min="-10"
      y_vel_max="10"
      count_min="5"
      count_max="5"
      lifetime_min="0.1"
      lifetime_max="0.3"
      create_real_particles="1"
      emit_cosmetic_particles="0"
      emission_interval_min_frames="60"
      emission_interval_max_frames="250"
      is_emitting="1"
    ></ParticleEmitterComponent>

    <ParticleEmitterComponent
      _tags="enabled_in_hand,enabled_in_world,fire"
      emitted_material_name="spark"
      custom_style="FIRE"
      offset.x="1"
      offset.y="-6"
      x_pos_offset_min="-2"
      x_pos_offset_max="-1"
      y_pos_offset_min="-2"
      y_pos_offset_max="1"
      x_vel_min="-2"
      x_vel_max="2"
      y_vel_min="-20"
      y_vel_max="-10"
      count_min="1"
      count_max="2"
      lifetime_min="0.3"
      lifetime_max="0.4"
      create_real_particles="1"
      emit_cosmetic_particles="0"
      emission_interval_min_frames="1"
      emission_interval_max_frames="3"
      is_emitting="1"
    ></ParticleEmitterComponent>

    <ParticleEmitterComponent
      _tags="enabled_in_hand,enabled_in_world,fire"
      emitted_material_name="spark"
      offset.x="1"
      offset.y="-6"
      x_pos_offset_min="-1"
      x_pos_offset_max="0"
      y_pos_offset_min="-2"
      y_pos_offset_max="1"
      x_vel_min="-2"
      x_vel_max="2"
      y_vel_min="-20"
      y_vel_max="-10"
      count_min="1"
      count_max="2"
      lifetime_min="0.3"
      lifetime_max="0.4"
      create_real_particles="1"
      emit_cosmetic_particles="0"
      emission_interval_min_frames="2"
      emission_interval_max_frames="6"
      is_emitting="1"
    ></ParticleEmitterComponent>

    <ParticleEmitterComponent
      _tags="enabled_in_hand,enabled_in_world,fire"
      emitted_material_name="fire"
      offset.x="1"
      offset.y="-4"
      x_pos_offset_min="-1"
      x_pos_offset_max="1"
      y_pos_offset_min="-1"
      y_pos_offset_max="1"
      x_vel_min="-2"
      x_vel_max="2"
      y_vel_min="-20"
      y_vel_max="-10"
      count_min="1"
      count_max="2"
      lifetime_min="0.3"
      lifetime_max="0.4"
      create_real_particles="1"
      emit_cosmetic_particles="0"
      emission_interval_min_frames="2"
      emission_interval_max_frames="6"
      fire_cells_dont_ignite_damagemodel="1"
    ></ParticleEmitterComponent>

  </Entity>

  <LuaComponent
    _tags="enabled_in_hand,enabled_in_world,fire"
    script_source_file="mods/AdventureMode/files/torch_light.lua"
    script_enabled_changed="mods/AdventureMode/files/torch_light.lua"
    execute_every_n_frame="1"
    execute_on_added="1"
  ></LuaComponent>

  <VariableStorageComponent
    name="is_on"
    value_bool="1"
  ></VariableStorageComponent>
<!-- MaterialSuckerComponent -->
    <!-- _tags="enabled_in_hand,enabled_in_inventory" -->
  <MaterialAreaCheckerComponent
    _tags="enabled_in_hand,enabled_in_inventory"
    look_for_failure="0"
    kill_after_message="0"
    material="water"
    material2="water"
    area_aabb.min_x="0"
    area_aabb.min_y="0"
    area_aabb.max_x="1"
    area_aabb.max_y="1"
  ></MaterialAreaCheckerComponent>

  <LuaComponent
    _tags="enabled_in_hand,enabled_in_inventory"
    script_material_area_checker_success="mods/AdventureMode/files/torch_material_checker.lua"
    execute_every_n_frame="-1"
  ></LuaComponent>

  <!-- <LuaComponent
    _tags="enabled_in_hand"
    script_enabled_changed="mods/AdventureMode/files/torch_in_hand.lua"
    execute_every_n_frame="-1"
  ></LuaComponent> -->
  <!-- <LuaComponent
    _tags="enabled_in_world"
    script_enabled_changed="mods/AdventureMode/files/torch_in_world.lua"
    execute_every_n_frame="-1"
  ></LuaComponent> -->

  <!-- <LuaComponent
    _tags="enabled_in_inventory"
    script_enabled_changed="mods/AdventureMode/files/torch.lua"
    execute_every_n_frame="-1"
  ></LuaComponent> -->

  <!-- <SpriteComponent
    _tags="enabled_in_world,enabled_in_hand,character"
    alpha="1"
    image_file="data/items_gfx/torch_emissive_center.xml"
    offset_x="0"
    offset_y="0"
    emissive="1"
    additive="0"
    smooth_filtering="0"
    next_rect_animation=""
    rect_animation="default"
     >
  </SpriteComponent> -->
<!--
   <SpriteComponent
    _tags="enabled_in_world,enabled_in_hand,character"
    alpha="1"
    image_file="data/items_gfx/torch_emissive.xml"
    offset_x="0"
    offset_y="0"
    emissive="1"
    additive="1"
    smooth_filtering="1"
    next_rect_animation=""
    rect_animation="default"
     >
  </SpriteComponent> -->

  <!-- <SpriteAnimatorComponent
    _tags="enabled_in_world,enabled_in_hand" >
  </SpriteAnimatorComponent> -->

</Entity>
